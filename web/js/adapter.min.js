//Version 8.1.2
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;(t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}}(function(){return(function(){function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var p=Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var d=r[a]={exports:{}};t[a][0].call(d.exports,function(e){return i(t[a][1][e]||e)},d,d.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}return e})()({1:[function(e,t,r){"use strict";var n=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},o=i.log,s=i.detectBrowser(r),p={browserDetails:s,commonShim:f,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings,sdp:l};switch(s.browser){case"chrome":if(!a||!a.shimPeerConnection||!n.shimChrome){o("Chrome shim is not included in this adapter release.");break}if(null===s.version){o("Chrome shim can not determine version, not shimming.");break}o("adapter.js shimming chrome."),p.browserShim=a,f.shimAddIceCandidateNullOrEmpty(r,s),f.shimParameterlessSetLocalDescription(r,s),a.shimGetUserMedia(r,s),a.shimMediaStream(r,s),a.shimPeerConnection(r,s),a.shimOnTrack(r,s),a.shimAddTrackRemoveTrack(r,s),a.shimGetSendersWithDtmf(r,s),a.shimGetStats(r,s),a.shimSenderReceiverGetStats(r,s),a.fixNegotiationNeeded(r,s),f.shimRTCIceCandidate(r,s),f.shimConnectionState(r,s),f.shimMaxMessageSize(r,s),f.shimSendThrowTypeError(r,s),f.removeExtmapAllowMixed(r,s);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox){o("Firefox shim is not included in this adapter release.");break}o("adapter.js shimming firefox."),p.browserShim=c,f.shimAddIceCandidateNullOrEmpty(r,s),f.shimParameterlessSetLocalDescription(r,s),c.shimGetUserMedia(r,s),c.shimPeerConnection(r,s),c.shimOnTrack(r,s),c.shimRemoveStream(r,s),c.shimSenderGetStats(r,s),c.shimReceiverGetStats(r,s),c.shimRTCDataChannel(r,s),c.shimAddTransceiver(r,s),c.shimGetParameters(r,s),c.shimCreateOffer(r,s),c.shimCreateAnswer(r,s),f.shimRTCIceCandidate(r,s),f.shimConnectionState(r,s),f.shimMaxMessageSize(r,s),f.shimSendThrowTypeError(r,s);break;case"safari":if(!d||!n.shimSafari){o("Safari shim is not included in this adapter release.");break}o("adapter.js shimming safari."),p.browserShim=d,f.shimAddIceCandidateNullOrEmpty(r,s),f.shimParameterlessSetLocalDescription(r,s),d.shimRTCIceServerUrls(r,s),d.shimCreateOfferLegacy(r,s),d.shimCallbacksAPI(r,s),d.shimLocalStreamsAPI(r,s),d.shimRemoteStreamsAPI(r,s),d.shimTrackEventTransceiver(r,s),d.shimGetUserMedia(r,s),d.shimAudioContext(r,s),f.shimRTCIceCandidate(r,s),f.shimMaxMessageSize(r,s),f.shimSendThrowTypeError(r,s),f.removeExtmapAllowMixed(r,s);break;default:o("Unsupported browser!")}return p};var n=e("./utils"),i=h(n),o=e("./chrome/chrome_shim"),a=h(o),s=e("./firefox/firefox_shim"),c=h(s),p=e("./safari/safari_shim"),d=h(p),u=e("./common_shim"),f=h(u),m=e("sdp"),l=h(m);function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./firefox/firefox_shim":7,"./safari/safari_shim":10,"./utils":11,sdp:12}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function e(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function e(){return o.shimGetDisplayMedia}}),r.shimMediaStream=function e(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},r.shimOnTrack=function e(t){if((void 0===t?"undefined":n(t))!=="object"||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)s.wrapPeerConnectionEvent(t,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function e(){return this._ontrack},set:function e(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function e(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(r){var i=void 0;i=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[e.stream],n.dispatchEvent(o)}),e.stream.getTracks().forEach(function(r){var i=void 0;i=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[e.stream],n.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var r=function e(t,r){return{track:r,get dtmf(){return void 0===this._dtmf&&("audio"===r.kind?this._dtmf=t.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function e(){return this._senders=this._senders||[],this._senders.slice()};var i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function e(t,n){var o=i.apply(this,arguments);return o||(o=r(this,t),this._senders.push(o)),o};var o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function e(t){o.apply(this,arguments);var r=this._senders.indexOf(t);-1!==r&&this._senders.splice(r,1)}}var a=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function e(t){var n=this;this._senders=this._senders||[],a.apply(this,[t]),t.getTracks().forEach(function(e){n._senders.push(r(n,e))})};var s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function e(t){var r=this;this._senders=this._senders||[],s.apply(this,[t]),t.getTracks().forEach(function(e){var t=r._senders.find(function(t){return t.track===e});t&&r._senders.splice(r._senders.indexOf(t),1)})}}else if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var c=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function e(){var t=this,r=c.apply(this,[]);return r.forEach(function(e){return e._pc=t}),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function e(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function e(t){if(t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function e(){var t=this,n=Array.prototype.slice.call(arguments),i=n[0],o=n[1],a=n[2];if(arguments.length>0&&"function"==typeof i)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof i))return r.apply(this,[]);var s=function e(t){var r={};return t.result().forEach(function(e){var t={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(r){t[r]=e.stat(r)}),r[t.id]=t}),r},c=function e(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};if(arguments.length>=2){var p=function e(t){o(c(s(t)))};return r.apply(this,[p,i])}return new Promise(function(e,n){r.apply(t,[function(t){e(c(s(t)))},n])}).then(o,a)}}},r.shimSenderReceiverGetStats=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function e(){var t=this,n=r.apply(this,[]);return n.forEach(function(e){return e._pc=t}),n});var i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function e(){var t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function e(){var t=this;return this._pc.getStats().then(function(e){return s.filterStats(e,t.track,!0)})}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var o=t.RTCPeerConnection.prototype.getReceivers;o&&(t.RTCPeerConnection.prototype.getReceivers=function e(){var t=this,r=o.apply(this,[]);return r.forEach(function(e){return e._pc=t}),r}),s.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function e(){var t=this;return this._pc.getStats().then(function(e){return s.filterStats(e,t.track,!1)})}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var a=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function e(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var r=arguments[0],n=void 0,i=void 0,o=void 0;return(this.getSenders().forEach(function(e){e.track===r&&(n?o=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===r&&(i?o=!0:i=e),e.track===r}),o||n&&i)?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=p,r.shimAddTrackRemoveTrack=function e(t,r){if(t.RTCPeerConnection){if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return p(t);var n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function e(){var t=this,r=n.apply(this);return this._reverseStreams=this._reverseStreams||{},r.map(function(e){return t._reverseStreams[e.id]})};var i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function e(r){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[r.id]){var o=new t.MediaStream(r.getTracks());this._streams[r.id]=o,this._reverseStreams[o.id]=r,r=o}i.apply(this,[r])};var o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function e(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function e(r,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find(function(e){return e===r}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===r}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[n.id];if(a)a.addTrack(r),Promise.resolve().then(function(){i.dispatchEvent(new Event("negotiationneeded"))});else{var s=new t.MediaStream([r]);this._streams[n.id]=s,this._reverseStreams[s.id]=n,this.addStream(s)}return this.getSenders().find(function(e){return e.track===r})},["createOffer","createAnswer"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=c({},e,function(){var e=this,t=arguments,n=arguments.length&&"function"==typeof arguments[0];return n?r.apply(this,[function(r){var n=d(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(t){return d(e,t)})});t.RTCPeerConnection.prototype[e]=n[e]});var a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function e(){var t,r,n;return arguments.length&&arguments[0].type?(arguments[0]=(t=this,r=arguments[0],n=r.sdp,Object.keys(t._reverseStreams||[]).forEach(function(e){var r=t._reverseStreams[e],i=t._streams[r.id];n=n.replace(RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:r.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function e(){var t=s.get.apply(this);return""===t.type?t:d(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function e(t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function d(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}},r.shimPeerConnection=function e(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r=t.RTCPeerConnection.prototype[e],n=c({},e,function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});t.RTCPeerConnection.prototype[e]=n[e]})},r.fixNegotiationNeeded=function e(t,r){s.wrapPeerConnectionEvent(t,"negotiationneeded",function(e){var t=e.target;if(!(r.version<72)&&(!t.getConfiguration||"plan-b"!==t.getConfiguration().sdpSemantics)||"stable"===t.signalingState)return e})};var a,s=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("../utils.js"));function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){e.RTCPeerConnection.prototype.getLocalStreams=function e(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function e(r,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function e(t){var n=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var i=this.getSenders();r.apply(this,arguments);var o=this.getSenders().filter(function(e){return -1===i.indexOf(e)});this._shimmedLocalStreams[t.id]=[t].concat(o)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function e(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function e(t){var r=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var n=r._shimmedLocalStreams[e].indexOf(t);-1!==n&&r._shimmedLocalStreams[e].splice(n,1),1===r._shimmedLocalStreams[e].length&&delete r._shimmedLocalStreams[e]}),i.apply(this,arguments)}}},{"../utils.js":11,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function e(t,r){if((!t.navigator.mediaDevices||!("getDisplayMedia"in t.navigator.mediaDevices))&&t.navigator.mediaDevices){if("function"!=typeof r){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function e(n){return r(n).then(function(e){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),t.navigator.mediaDevices.getUserMedia(n)})}}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function e(t,r){var i=t&&t.navigator;if(i.mediaDevices){var o=function e(t){if((void 0===t?"undefined":n(t))!=="object"||t.mandatory||t.optional)return t;var r={};return Object.keys(t).forEach(function(e){if("require"!==e&&"advanced"!==e&&"mediaSource"!==e){var i="object"===n(t[e])?t[e]:{ideal:t[e]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var o=function e(t,r){return t?t+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==i.ideal){r.optional=r.optional||[];var a={};"number"==typeof i.ideal?(a[o("min",e)]=i.ideal,r.optional.push(a),(a={})[o("max",e)]=i.ideal,r.optional.push(a)):(a[o("",e)]=i.ideal,r.optional.push(a))}void 0!==i.exact&&"number"!=typeof i.exact?(r.mandatory=r.mandatory||{},r.mandatory[o("",e)]=i.exact):["min","max"].forEach(function(t){void 0!==i[t]&&(r.mandatory=r.mandatory||{},r.mandatory[o(t,e)]=i[t])})}}),t.advanced&&(r.optional=(r.optional||[]).concat(t.advanced)),r},s=function e(t,s){if(r.version>=61)return s(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"===n(t.audio)){var c=function e(t,r,n){r in t&&!(n in t)&&(t[n]=t[r],delete t[r])};c((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),c(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=o(t.audio)}if(t&&"object"===n(t.video)){var p=t.video.facingMode;p=p&&((void 0===p?"undefined":n(p))==="object"?p:{ideal:p});var d=r.version<66;if(p&&("user"===p.exact||"environment"===p.exact||"user"===p.ideal||"environment"===p.ideal)&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete t.video.facingMode;var u=void 0;if("environment"===p.exact||"environment"===p.ideal?u=["back","rear"]:("user"===p.exact||"user"===p.ideal)&&(u=["front"]),u)return i.mediaDevices.enumerateDevices().then(function(e){var r=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(e){return u.some(function(t){return e.label.toLowerCase().includes(t)})});return!r&&e.length&&u.includes("back")&&(r=e[e.length-1]),r&&(t.video.deviceId=p.exact?{exact:r.deviceId}:{ideal:r.deviceId}),t.video=o(t.video),a("chrome: "+JSON.stringify(t)),s(t)})}t.video=o(t.video)}return a("chrome: "+JSON.stringify(t)),s(t)},c=function e(t){return r.version>=64?t:{name:({PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"})[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function e(){return this.name+(this.message&&": ")+this.message}}},p=function e(t,r,n){s(t,function(e){i.webkitGetUserMedia(e,r,function(e){n&&n(c(e))})})};if(i.getUserMedia=p.bind(i),i.mediaDevices.getUserMedia){var d=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(e){return s(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(c(e))})})}}}};var i,o,a=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("../utils.js")).log},{"../utils.js":11}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function e(t){if(t.RTCIceCandidate&&(!t.RTCIceCandidate||!("foundation"in t.RTCIceCandidate.prototype))){var r=t.RTCIceCandidate;t.RTCIceCandidate=function e(t){if((void 0===t?"undefined":i(t))==="object"&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substr(2)),t.candidate&&t.candidate.length){var n,o=Object.assign(new r(t),s.default.parseCandidate(t.candidate));return o.toJSON=function e(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new r(t)},t.RTCIceCandidate.prototype=r.prototype,c.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})}},r.shimMaxMessageSize=function e(t,r){if(t.RTCPeerConnection){"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function e(){return void 0===this._sctp?null:this._sctp}});var n=function e(t){if(!t||!t.sdp)return!1;var r=s.default.splitSections(t.sdp);return r.shift(),r.some(function(e){var t=s.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},i=function e(t){var r=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===r||r.length<2)return -1;var n=parseInt(r[1],10);return n!=n?-1:n},o=function e(t){var n=65536;return"firefox"===r.browser&&(n=r.version<57?-1===t?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),n},a=function e(t,n){var i=65536;"firefox"===r.browser&&57===r.version&&(i=65535);var o=s.default.matchPrefix(t.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===r.browser&&-1!==n&&(i=2147483637),i},c=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function e(){if(this._sctp=null,"chrome"===r.browser&&r.version>=76&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function e(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),n(arguments[0])){var t=i(arguments[0]),s=o(t),p=a(arguments[0],t),d=void 0;d=0===s&&0===p?Number.POSITIVE_INFINITY:0===s||0===p?Math.max(s,p):Math.min(s,p);var u={};Object.defineProperty(u,"maxMessageSize",{get:function e(){return d}}),this._sctp=u}return c.apply(this,arguments)}}},r.shimSendThrowTypeError=function e(t){if(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype){var r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function e(){var t=r.apply(this,arguments);return n(t,this),t},c.wrapPeerConnectionEvent(t,"datachannel",function(e){return n(e.channel,e.target),e})}function n(e,t){var r=e.send;e.send=function n(){var i=arguments[0],o=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}},r.shimConnectionState=function e(t){if(t.RTCPeerConnection&&!("connectionState"in t.RTCPeerConnection.prototype)){var r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function e(){return({completed:"connected",checking:"connecting"})[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function e(){return this._onconnectionstatechange||null},set:function e(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})}},r.removeExtmapAllowMixed=function e(t,r){if(t.RTCPeerConnection&&("chrome"!==r.browser||!(r.version>=71))&&("safari"!==r.browser||!(r.version>=605))){var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function e(r){if(r&&r.sdp&&-1!==r.sdp.indexOf("\na=extmap-allow-mixed")){var i=r.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n");t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:i}):r.sdp=i}return n.apply(this,arguments)}}},r.shimAddIceCandidateNullOrEmpty=function e(t,r){if(t.RTCPeerConnection&&t.RTCPeerConnection.prototype){var n=t.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(t.RTCPeerConnection.prototype.addIceCandidate=function e(){return arguments[0]?("chrome"===r.browser&&r.version<78||"firefox"===r.browser&&r.version<68||"safari"===r.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}},r.shimParameterlessSetLocalDescription=function e(t,r){if(t.RTCPeerConnection&&t.RTCPeerConnection.prototype){var n=t.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(t.RTCPeerConnection.prototype.setLocalDescription=function e(){var t=this,r=arguments[0]||{};if((void 0===r?"undefined":i(r))!=="object"||r.type&&r.sdp)return n.apply(this,arguments);if(!(r={type:r.type,sdp:r.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer"}return r.sdp||"offer"!==r.type&&"answer"!==r.type?n.apply(this,[r]):("offer"===r.type?this.createOffer:this.createAnswer).apply(this).then(function(e){return n.apply(t,[e])})})}};var o,a,s=(n=e("sdp"),n&&n.__esModule?n:{default:n}),c=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("./utils"))},{"./utils":11,sdp:12}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function e(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function e(){return o.shimGetDisplayMedia}}),r.shimOnTrack=function e(t){(void 0===t?"undefined":n(t))==="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function e(){return{receiver:this.receiver}}})},r.shimPeerConnection=function e(t,r){if((void 0===t?"undefined":n(t))==="object"&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var r,n,i,o=t.RTCPeerConnection.prototype[e],a=(r={},n=e,i=function(){return arguments[0]=new("addIceCandidate"===e?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)},n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r);t.RTCPeerConnection.prototype[e]=a[e]});var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function e(){var t=Array.prototype.slice.call(arguments),n=t[0],a=t[1],s=t[2];return o.apply(this,[n||null]).then(function(e){if(r.version<53&&!a)try{e.forEach(function(e){e.type=i[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:i[t.type]||t.type}))})}return e}).then(a,s)}}},r.shimSenderGetStats=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpSender.prototype))){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function e(){var t=this,n=r.apply(this,[]);return n.forEach(function(e){return e._pc=t}),n});var i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function e(){var t=i.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function e(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpReceiver.prototype))){var r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function e(){var t=this,n=r.apply(this,[]);return n.forEach(function(e){return e._pc=t}),n}),s.wrapPeerConnectionEvent(t,"track",function(e){return e.receiver._pc=e.srcElement,e}),t.RTCRtpReceiver.prototype.getStats=function e(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function e(t){t.RTCPeerConnection&&!("removeStream"in t.RTCPeerConnection.prototype)&&(t.RTCPeerConnection.prototype.removeStream=function e(t){var r=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})})},r.shimRTCDataChannel=function e(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)},r.shimAddTransceiver=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function e(){this.setParametersPromises=[];var t=arguments[1]&&arguments[1].sendEncodings;void 0===t&&(t=[]);var n=(t=[].concat(function e(t){if(!Array.isArray(t))return Array.from(t);for(var r=0,n=Array(t.length);r<t.length;r++)n[r]=t[r];return n}(t))).length>0;n&&t.forEach(function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw RangeError("max_framerate must be >= 0.0")});var i=r.apply(this,arguments);if(n){var o=i.sender,a=o.getParameters();"encodings"in a&&(1!==a.encodings.length||0!==Object.keys(a.encodings[0]).length)||(a.encodings=t,o.sendEncodings=t,this.setParametersPromises.push(o.setParameters(a).then(function(){delete o.sendEncodings}).catch(function(){delete o.sendEncodings})))}return i})}},r.shimGetParameters=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCRtpSender){var r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function e(){var t=r.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}},r.shimCreateOffer=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function e(){var t=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return r.apply(t,n)}).finally(function(){t.setParametersPromises=[]}):r.apply(this,arguments)}}},r.shimCreateAnswer=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function e(){var t=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return r.apply(t,n)}).finally(function(){t.setParametersPromises=[]}):r.apply(this,arguments)}}};var a,s=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("../utils"))},{"../utils":11,"./getdisplaymedia":8,"./getusermedia":9}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function e(t,r){(!t.navigator.mediaDevices||!("getDisplayMedia"in t.navigator.mediaDevices))&&t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function e(n){if(!(n&&n.video)){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:r}:n.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(n)})}},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function e(t,r){var i=t&&t.navigator,a=t&&t.MediaStreamTrack;if(i.getUserMedia=function(e,t,r){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,r)},!(r.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){var s=function e(t,r,n){r in t&&!(n in t)&&(t[n]=t[r],delete t[r])},c=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(e){return(void 0===e?"undefined":n(e))==="object"&&"object"===n(e.audio)&&(s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),c(e)},a&&a.prototype.getSettings){var p=a.prototype.getSettings;a.prototype.getSettings=function(){var e=p.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(a&&a.prototype.applyConstraints){var d=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return"audio"===this.kind&&(void 0===e?"undefined":n(e))==="object"&&(s(e=JSON.parse(JSON.stringify(e)),"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var i,o=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("../utils"))},{"../utils":11}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function e(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){var r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function e(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return r.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return r.call(n,e,t)})},t.RTCPeerConnection.prototype.addTrack=function e(t){for(var n=this,i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return o&&o.forEach(function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]}),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function e(t){var r=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(t);if(-1!==n){this._localStreams.splice(n,1);var i=t.getTracks();this.getSenders().forEach(function(e){i.includes(e.track)&&r.removeTrack(e)})}})}},r.shimRemoteStreamsAPI=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function e(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function e(){return this._onaddstream},set:function e(t){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(e)){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})})}});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function e(){var t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}})}),r.apply(t,arguments)}}},r.shimCallbacksAPI=function e(t){if((void 0===t?"undefined":n(t))==="object"&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype,i=r.createOffer,o=r.createAnswer,a=r.setLocalDescription,s=r.setRemoteDescription,c=r.addIceCandidate;r.createOffer=function e(t,r){var n=arguments.length>=2?arguments[2]:arguments[0],o=i.apply(this,[n]);return r?(o.then(t,r),Promise.resolve()):o},r.createAnswer=function e(t,r){var n=arguments.length>=2?arguments[2]:arguments[0],i=o.apply(this,[n]);return r?(i.then(t,r),Promise.resolve()):i};var p=function e(t,r,n){var i=a.apply(this,[t]);return n?(i.then(r,n),Promise.resolve()):i};r.setLocalDescription=p,p=function e(t,r,n){var i=s.apply(this,[t]);return n?(i.then(r,n),Promise.resolve()):i},r.setRemoteDescription=p,p=function e(t,r,n){var i=c.apply(this,[t]);return n?(i.then(r,n),Promise.resolve()):i},r.addIceCandidate=p}},r.shimGetUserMedia=function e(t){var r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){var n=r.mediaDevices,i=n.getUserMedia.bind(n);r.mediaDevices.getUserMedia=function(e){return i(a(e))}}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function e(t,n,i){r.mediaDevices.getUserMedia(t).then(n,i)}).bind(r))},r.shimConstraints=a,r.shimRTCIceServerUrls=function e(t){if(t.RTCPeerConnection){var r=t.RTCPeerConnection;t.RTCPeerConnection=function e(t,n){if(t&&t.iceServers){for(var i=[],a=0;a<t.iceServers.length;a++){var s=t.iceServers[a];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,i.push(s)):i.push(t.iceServers[a])}t.iceServers=i}return new r(t,n)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function e(){return r.generateCertificate}})}},r.shimTrackEventTransceiver=function e(t){(void 0===t?"undefined":n(t))==="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function e(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function e(t){var r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function e(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);var n=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===t.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==t.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);var i=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===t.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==t.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}},r.shimAudioContext=function e(t){(void 0===t?"undefined":n(t))==="object"&&!t.AudioContext&&(t.AudioContext=t.webkitAudioContext)};var i,o=function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}(e("../utils"));function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":11}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=a,r.wrapPeerConnectionEvent=function e(t,r,n){if(t.RTCPeerConnection){var i=t.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(e,t){if(e!==r)return o.apply(this,arguments);var i=function e(r){var i=n(r);i&&(t.handleEvent?t.handleEvent(i):t(i))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(t,i),o.apply(this,[e,i])};var a=i.removeEventListener;i.removeEventListener=function(e,t){if(e!==r||!this._eventMap||!this._eventMap[r]||!this._eventMap[r].has(t))return a.apply(this,arguments);var n=this._eventMap[r].get(t);return this._eventMap[r].delete(t),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,n])},Object.defineProperty(i,"on"+r,{get:function e(){return this["_on"+r]},set:function e(t){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),t&&this.addEventListener(r,this["_on"+r]=t)},enumerable:!0,configurable:!0})}},r.disableLog=function e(t){return"boolean"!=typeof t?Error("Argument type: "+(void 0===t?"undefined":n(t))+". Please use a boolean."):(i=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function e(t){return"boolean"!=typeof t?Error("Argument type: "+(void 0===t?"undefined":n(t))+". Please use a boolean."):(o=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},r.log=function e(){("undefined"==typeof window?"undefined":n(window))==="object"&&!i&&"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},r.deprecated=function e(t,r){o&&console.warn(t+" is deprecated, please use "+r+" instead.")},r.detectBrowser=function e(t){var r={browser:null,version:null};if(void 0===t||!t.navigator)return r.browser="Not a browser.",r;var n=t.navigator;return n.mozGetUserMedia?(r.browser="firefox",r.version=a(n.userAgent,/Firefox\/(\d+)\./,1)):n.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection?(r.browser="chrome",r.version=a(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./)?(r.browser="safari",r.version=a(n.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype):r.browser="Not a supported browser.",r},r.compactObject=function e(t){return s(t)?Object.keys(t).reduce(function(r,n){var i,o,a,c=s(t[n]),p=c?e(t[n]):t[n],d=c&&!Object.keys(p).length;return void 0===p||d?r:Object.assign(r,(i={},o=n,a=p,o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,i))},{}):t},r.walkStats=c,r.filterStats=function e(t,r,n){var i=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===r)return o;var a=[];return t.forEach(function(e){"track"===e.type&&e.trackIdentifier===r.id&&a.push(e)}),a.forEach(function(e){t.forEach(function(r){r.type===i&&r.trackId===e.id&&c(t,r,o)})}),o};var i=!0,o=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,r){!(!t||r.has(t.id))&&(r.set(t.id,t),Object.keys(t).forEach(function(n){n.endsWith("Id")?c(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach(function(t){c(e,e.get(t),r)})}))}},{}],12:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i={};i.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},i.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},i.parseCandidate=function(e){for(var t=void 0,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:void 0===r[t[n]]&&(r[t[n]]=t[n+1])}return r},i.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t={},r=void 0,n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)t[(r=n[i].trim().split("="))[0].trim()]=r[1];return t},i.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},i.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},i.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===n(e.keyParams)?i.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},i.getCryptoParameters=function(e,t){return i.matchPrefix(e+t,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(e,t){var r=i.matchPrefix(e+t,"a=ice-ufrag:")[0],n=i.matchPrefix(e+t,"a=ice-pwd:")[0];return r&&n?{usernameFragment:r.substr(12),password:n.substr(10)}:null},i.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=i.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var o=r[n],a=i.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=i.parseRtpMap(a),c=i.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?i.parseFmtp(c[0]):{},s.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(i.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(i.parseExtmap(e))}),t},i.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=i.writeRtpMap(e),r+=i.writeFmtp(e),r+=i.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(e){e.maxptime>n&&(n=e.maxptime)}),n>0&&(r+="a=maxptime:"+n+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=i.writeExtmap(e)}),r},i.parseRtpEncodingParameters=function(e){var t=[],r=i.parseRtpParameters(e),n=-1!==r.fecMechanisms.indexOf("RED"),o=-1!==r.fecMechanisms.indexOf("ULPFEC"),a=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=a.length>0&&a[0].ssrc,c=void 0,p=i.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});p.length>0&&p[0].length>1&&p[0][0]===s&&(c=p[0][1]),r.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(r.rtx={ssrc:c}),t.push(r),n&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},t.push(r))}}),0===t.length&&s&&t.push({ssrc:s});var d=i.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?950*parseInt(d[0].substr(5),10)-16e3:void 0,t.forEach(function(e){e.maxBitrate=d})),t},i.parseRtcpParameters=function(e){var t={},r=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var o=i.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},i.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},i.parseMsid=function(e){var t=void 0,r=i.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});if(n.length>0)return{stream:(t=n[0].value.split(" "))[0],track:t[1]}},i.parseSctpDescription=function(e){var t=i.parseMLine(e),r=i.matchPrefix(e,"a=max-message-size:"),n=void 0;r.length>0&&(n=parseInt(r[0].substr(19),10)),isNaN(n)&&(n=65536);var o=i.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:t.fmt,maxMessageSize:n};var a=i.matchPrefix(e,"a=sctpmap:");if(a.length>0){var s=a[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},i.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,r){var n=void 0;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(n=e||i.generateSessionId())+" "+(void 0!==t?t:2)+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.getDirection=function(e,t){for(var r=i.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},(void 0===t?"undefined":n(t))==="object"&&(t.exports=i)},{}]},{},[1])(1)});